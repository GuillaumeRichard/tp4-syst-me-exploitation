from clientManager import ClientManager
from file_system import FileSystem
import sl4a

class AndroidInterface:
    root = '../dropbox/'
    ipInfo = 'ipInfo.txt'
    fileSystem = FileSystem
    ipInfoContent = ''

    def __init__(self):
        self.fileSystem = FileSystem(self.root)
        folderIsEmpty = self.fileSystem.folder_is_empty('')
        self.ipInfoContent = self.fileSystem.get_file_content(self.ipInfo)
        if folderIsEmpty == False :
            self.deleteDropboxWindow()
        elif self.ipInfoContent == '' :
            self.ipInfoWindow()
        else :
            self.updateLoop()

    def deleteDropboxWindow(self):
        title = 'Dropbox'
        message = ('Voulez-vous effacer l\'arboresence '
                   'Dropbox locale existante?')
        droid = sl4a.Android()
        droid.dialogCreateAlert(title, message)
        droid.dialogSetPositiveButtonText('Yes')
        droid.dialogSetNegativeButtonText('No')
        droid.dialogShow()
        response = droid.dialogGetResponse().result

        if response :
            self.fileSystem.clean_local_dropBox()
        elif self.ipInfoContent == '' :
            self.ipInfoWindow()

    def ipInfoWindow(self):
        droid = sl4a.Android()
        name = droid.dialogGetInput("Hello!", "What is your name?")
        droid.makeToast("Hello, %s" % name.result)